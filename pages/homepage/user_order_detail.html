<!DOCTYPE html>

<html lang="en">

    <head>

        <meta charset="UTF-8">
        <link rel="icon" type="image/x-icon" href="../../assets/images/favicon.png">

        <title> Global Fun City </title>
        <link rel="stylesheet" href="../../assets/homepage css/user_order_detail.css">

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Inter+Tight&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Nanum+Pen+Script&family=Open+Sans:wght@700&family=Poppins:wght@300;500&family=Reem+Kufi&family=Sacramento&display=swap" rel="stylesheet">

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@500&family=Poppins:wght@300;500&family=Rubik+Microbe&display=swap" rel="stylesheet">

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    </head>
    <body>

        <div class="header">
            <a href="../../index.html">
                <img src="../../assets/images/globalfuncitylogo.png" class="header-logo" width="200px" alt="logo">
            </a>
            <nav class="navbar">
                <ul>
                    <li>
                        <a class="navigation__link" href="../../index.html">
                            <b>HOME</b>
                        </a>
                    </li>
                    <li>
                        <a class="navigation__link" href="../../pages/other pages/home.html">
                            <b>ABOUT</b> 
                        </a> 
                    </li>
                    <li>
                        <a class="navigation__link" href="../../pages/other pages/events.html">
                            <b>EVENTS </b> 
                        </a> 
                    </li>
                    <li>
                        <a class="navigation__link" href="../../pages/other pages/offer.html">
                            <b>OFFERS </b> 
                        </a> 
                    </li>
                    <li>
                        <a class="navigation__link" href="../../pages/other pages/ticketprices.html">
                            <b>TICKET  PRICES </b>
                        </a> 
                    </li>
                    <li>
                        <a class="navigation__link" href="../../pages/shop/shop.html">
                            <b>SHOP</b>
                        </a> 
                    </li>
                    <li>
                        <a class="navigation__link" href="../../pages/other pages/attractions.html">
                            <b>ATTRACTIONS </b>
                        </a> 
                    </li>
                    <li>
                        <a class="navigation__link" href="../../pages/other pages/contact.html">
                            <b>CONTACT </b> 
                        </a> 
                    </li>
         
                </ul>
    
            </nav>
            <div>
                <button>
                    <a href="../../pages/other pages/booknow.html">
                        <b>BOOK NOW </b> 
                    </a>
                </button>
            </div>
        </div>
<div class="background-color-for-whole-page" style="background-color: #eee; height: 600px;">
        <div class="total-homepages-div"> 
            <!-- Total Homepage div -->
        <div class="homepages">
            <a href="../../index.html">Home <i class="fa-light fa-greater-than" style="color: #655b5b;"></i></a>
        </div> &nbsp;
        <div class="homepages">
            <a href="../../pages/homepage/main.profile.html">Account <i class="fa-light fa-greater-than" style="color: #655b5b;"></i></a>
        </div> &nbsp;
        <div class="homepages">
            <a href="../../pages/homepage/user_orders.html">Your Orders <i class="fa-light fa-greater-than" style="color: #655b5b;"></i></a>
        </div> &nbsp;
        <div class="homepages">
            <a href="../../pages/homepage/user_order_detail.html">Order Detail</a>
        </div>

        </div>
        <!-- Completing Div -->

<!-- Starting ticket detail -->
<div class="background-color-for-detail">
    <!-- <div class="box">
        <div class="delivery-address">
            <h3 class="delivery-address-h3">Delivery Address</h3>
            <h5 class="name-of-the-user">Hello</h5>
            <p class="delivery-address-of-the-user">
                2/47 Keela Krishnan Kovil St, Keelapudur road, Palakarai, Trichy-1. <br> Trichy, Tiruchirappalli - 620001, Tamil Nadu
            </p>
            <p class="zip-code">ZIP Code: 000001</p>
            <p class="phone-number">Phone Number  &nbsp; 1234567890</p>
        </div>

        <div class="more-actions">
            <h3 class="more-actions-h3">More Actions</h3>
            <!-- Div for download and display -->
            <!-- <div class="download-invoice-div-flex">
            <div class="download-invoice-div">
                <p class="download-icon"><i class="fa-sharp fa-solid fa-file"></i> Download Invoice</p>
            </div>
            &NonBreakingSpace;
            <div class="btn-download">
                <button class="btn-download-invoice">Download</button>
            </div>
</div>    -->
<!-- Closed div for flex -->
        <!-- </div>
    </div>
</div>
<!-- 
Starting Product detail -->
<!-- <br> <br> <br>
<div class="background-color-for-product-detail">
    <!-- Flex for Product -->
    <!-- <div class="flex-of-product">
    <div class="product-image">
        <img src="https://iili.io/HX7ia1I.jpg" class="product-chosen-by-user" width="180px" height="180px" alt="shirt">
    </div>
    <div class="product-name">
        <h4 class="name-of-the-product">White T-Shirt With Logo</h4>
        <h5 class="size-of-the-product">Size : M</h5>
        <h5 class="price-of-the-product">Price : $100.00</h5>
    </div>
    </div>

    <div class="quantity-total-price">
        <h5 class="qty-of-the-product">Qty : 01</h5>
        <h5 class="total-price-of-the-product">Total Price : $100.00</h5>
        <h5 class="shipping-details-of-the-product">Delivery Status : Shipped</h5>
    </div>

    <div class="order-id-needhelp">
        <h5 class="order-id">Order ID : 1234567890</h5>
        <h5 class="need-help"><i class="fa-solid fa-square-question"></i> <a href="">Need Help</a></h5>
    </div>
</div> --> 



</div>
        <script src="../../js/header.js"></script>
<script>

const productIdForUrl = new URLSearchParams(window.location.search).get("orderId");

const gettingOrderData = JSON.parse(localStorage.getItem("orderDataFromUser")); 
console.log(gettingOrderData);

const user_id = JSON.parse(localStorage.getItem("unique_id")); 

const clothingDetails = JSON.parse(localStorage.getItem("clothing_details"));

const accessoriesDetails = JSON.parse(localStorage.getItem("accessories_details"));

const homeProducts = JSON.parse(localStorage.getItem("home_details"));

const orderIdfromTheUser = JSON.parse(localStorage.getItem("usersfromCheckoutData"));

const allProductIds = clothingDetails.concat(accessoriesDetails,homeProducts);
console.log(allProductIds)

// const findProductDetails = allProductIds.find((data) => data.product_uuid === gettingOrderData.productIdFromTheUserBag);

const findOrdersDetails = allProductIds.filter(data  =>
gettingOrderData.some((p) => p.productIdFromTheUserBag === data.product_uuid))
console.log(findOrdersDetails);

// const getOrderData = proId.find((data => data.orderId === productIdForUrl));
// console.log(getOrderData);

//const [firstOrderUser] = orderIdfromTheUser;

//if(findProductDetails){

//Creating DOM:

orderIdfromTheUser.forEach((orderUser) => {

    if(orderUser.productUserUniqueId === user_id){

// Create delivery address elements
const deliveryAddressTotalDiv = document.createElement("div");
deliveryAddressTotalDiv.classList.add("box");

const deliveryAddressDiv = document.createElement('div');
deliveryAddressDiv.classList.add('delivery-address');

const deliveryAddressHeader = document.createElement("h3");
deliveryAddressHeader.classList.add("delivery-address-h3");
deliveryAddressHeader.innerText = "Delivery Address";

const nameOfTheUser = document.createElement("h5");
nameOfTheUser.classList.add("name-of-the-user");
nameOfTheUser.innerText = orderUser.firstName;

const deliveryAddressOfTheUser = document.createElement("p");
deliveryAddressOfTheUser.classList.add("delivery-address-of-the-user");
deliveryAddressOfTheUser.innerHTML =  orderUser.doorNo + ", " + orderUser.streetAddress + ", " + orderUser.townCity + ", " + orderUser.state + ", " + orderUser.countryRegion + "." 
const zipCode = document.createElement("p");
zipCode.classList.add("zip-code");
zipCode.innerText = "ZIP Code: " + orderUser.zipCode;

const phoneNumber = document.createElement("p");
phoneNumber.classList.add("phone-number");
phoneNumber.innerHTML = "Phone Number  &nbsp; " + orderUser.phone;

deliveryAddressDiv.appendChild(deliveryAddressHeader);
deliveryAddressDiv.appendChild(nameOfTheUser);
deliveryAddressDiv.appendChild(deliveryAddressOfTheUser);
deliveryAddressDiv.appendChild(zipCode);
deliveryAddressDiv.appendChild(phoneNumber);

// Create more actions elements
const moreActionsDiv = document.createElement("div");
moreActionsDiv.classList.add("more-actions");

const moreActionsHeader = document.createElement("h3");
moreActionsHeader.classList.add("more-actions-h3");
moreActionsHeader.innerText = "More Actions";

const downloadInvoiceDivFlex = document.createElement("div");
downloadInvoiceDivFlex.classList.add("download-invoice-div-flex");

const downloadInvoiceDiv = document.createElement("div");
downloadInvoiceDiv.classList.add("download-invoice-div");

const downloadIcon = document.createElement("p");
downloadIcon.classList.add("download-icon");
downloadIcon.innerHTML = '<i class="fa-sharp fa-solid fa-file"></i> Download Invoice';

const downloadButton = document.createElement("button");
downloadButton.classList.add("btn-download-invoice");
downloadButton.innerText = "Download";

downloadInvoiceDiv.appendChild(downloadIcon);
downloadInvoiceDivFlex.appendChild(downloadInvoiceDiv);

downloadInvoiceDivFlex.appendChild(document.createTextNode("\u00A0"));
downloadInvoiceDivFlex.appendChild(downloadButton);

moreActionsDiv.appendChild(moreActionsHeader);
moreActionsDiv.appendChild(downloadInvoiceDivFlex);

const br1 = document.createElement("br");
const br2 = document.createElement("br");
const br3 = document.createElement("br");


// Create the outermost div element
const outerDiv = document.createElement('div');
outerDiv.classList.add('background-color-for-product-detail');

// Create the flex container div element
const flexContainerDiv = document.createElement('div');
flexContainerDiv.classList.add('flex-of-product');

// Create the product image div element and add the image element inside it
const productImageDiv = document.createElement('div');
productImageDiv.classList.add('product-image');

const productImage = document.createElement('img');
productImage.src = findOrdersDetails[0].product_photo;
productImage.classList.add('product-chosen-by-user');
productImage.width = '180';
productImage.height = '180';
productImage.alt = findOrdersDetails[0].product_name;
productImageDiv.appendChild(productImage);

// Create the product name div element and add the product name, size, and price elements inside it
const productNameDiv = document.createElement('div');
productNameDiv.classList.add('product-name');

const productName = document.createElement('h4');
productName.classList.add('name-of-the-product');

productName.textContent = findOrdersDetails[0].product_name;

const productSize = document.createElement('h5');
productSize.classList.add('size-of-the-product');
productSize.textContent = 'Size : ' + findOrdersDetails[0].productSize;

const productPrice = document.createElement('h5');
productPrice.classList.add('price-of-the-product');
productPrice.textContent = 'Price : $ ' + findOrdersDetails[0].product_price;

productNameDiv.appendChild(productName);
productNameDiv.appendChild(productSize);
productNameDiv.appendChild(productPrice);

// Add the product image and name divs inside the flex container div
flexContainerDiv.appendChild(productImageDiv);
flexContainerDiv.appendChild(productNameDiv);

// Create the quantity, total price, and shipping details div element and add those elements inside it
const quantityTotalPriceDiv = document.createElement('div');
quantityTotalPriceDiv.classList.add('quantity-total-price');

const productQty = document.createElement('h5');
productQty.classList.add('qty-of-the-product');
productQty.textContent = 'Qty : ' + gettingOrderData[0].productQty;

const totalAmount = parseInt(findOrdersDetails[0].product_price * gettingOrderData[0].productQty);


const totalProductPrice = document.createElement('h5');
totalProductPrice.classList.add('total-price-of-the-product');
totalProductPrice.textContent = 'Total Price : $' + totalAmount + ".00";

const orderDate = document.createElement('h5');
orderDate.classList.add('order-date');
orderDate.textContent = 'Order Date : ' + gettingOrderData[0].nowDate;

quantityTotalPriceDiv.appendChild(productQty);
quantityTotalPriceDiv.appendChild(totalProductPrice);
quantityTotalPriceDiv.appendChild(orderDate);

// Create the order ID and need help div element and add those elements inside it
const orderIdNeedHelpDiv = document.createElement('div');
orderIdNeedHelpDiv.classList.add('order-id-needhelp');

const shippingDetails = document.createElement('h5');
shippingDetails.classList.add('shipping-details-of-the-product');
shippingDetails.textContent = 'Delivery Status : ' + gettingOrderData[0].deliveryStatus;

const orderId = document.createElement('h5');
orderId.classList.add('order-id');
orderId.textContent = 'Order ID : ' + gettingOrderData[0].orderId;

const needHelp = document.createElement('button');
needHelp.classList.add('need-help');

const needHelpIcon = document.createElement('i');
needHelpIcon.classList.add('fa-solid', 'fa-square-question');
needHelpIcon.textContent = "Cancel Order";

const needHelpLink = document.createElement('a');
needHelpLink.href = '#';
needHelpLink.textContent = 'Need Help';
needHelp.addEventListener("click", function() {
  // Delete data from localStorage
  localStorage.removeItem("orderDataFromUser");
  localStorage.removeItem("usersfromCheckoutData");
  
  // Show alert
  alert("Order cancelled successfully!");
  
  // Redirect to the home page
  window.location.href = "../../index.html";
});


needHelp.appendChild(needHelpIcon);
//needHelp.appendChild(needHelpLink);

orderIdNeedHelpDiv.appendChild(shippingDetails);
orderIdNeedHelpDiv.appendChild(orderId);
orderIdNeedHelpDiv.appendChild(needHelp);

// Add the flex container, quantity/total price, and order ID/need help divs inside the outermost div
//outerDiv.appendChild(br1);
outerDiv.appendChild(flexContainerDiv);
outerDiv.appendChild(quantityTotalPriceDiv);
outerDiv.appendChild(orderIdNeedHelpDiv);



//total append the first div
deliveryAddressTotalDiv.appendChild(deliveryAddressDiv);
deliveryAddressTotalDiv.appendChild(moreActionsDiv)

document.querySelector(".background-color-for-detail").append(deliveryAddressTotalDiv, br1, br2 , br3, outerDiv);
    }
})



</script>

        </body>
        </html>